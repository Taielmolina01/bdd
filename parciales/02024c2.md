1.1 Se necesita un informe por cada año y producto que refleje: el año, el nombre del
producto y el promedio de hectáreas utilizadas por cada producto en ese año. El informe debe
abarcar desde el año 2010 hasta el año 2020 y se deben omitir los herbicidas.

SELECT DATE_PART('YEAR', c.fecha_cosecha) as año, p.nombre, AVG(c.area_hectareas) AS promedio_hectareas
FROM Productos p
    INNER JOIN Cultivos c ON p.id = c.id_producto 
WHERE p.tipo <> 'Herbicida' AND año BETWEEN 2010 AND 2020
GROUP BY año, p.nombre
ORDER BY año, p.nombre

1.2 (SQL) Se necesita saber el rendimiento de los empleados (no supervisores u otro puesto).
Se pide obtener los 10 "empleados" con la menor cantidad de productos vendidos en el último
año. Pero se requiere que se muestren sólo los empleados que tienen menos de 3 años en la
empresa.

SELECT e.id, e.nombre, e.apellido, SUM(v.cantidad_vendida) AS total_vendido
FROM Empleados e
    INNER JOIN Ventas v ON v.id_empleado = e.id
WHERE e.puesto = 'Empleado' AND 
    e.fecha_contratacion - CURRENT_DATE < 3 AND
    v.fecha_venta - CURRENT_DATE < 1
GROUP BY e.id, e.nombre, e.apellido
ORDER BY total_vendido ASC
LIMIT 10

2. (Algebra relacional) Dados los mismos esquemas del ejercicio 1.1 y utilizando la siguiente
notación para representar las operaciones del álgebra relacional: π, σ, ρ, ×, ∪, −, ∩, ⋊⋉, ÷,
resuelva la siguiente consulta:
Hallar los nombres de los productos que se vendieron el “ultimo dia”.

// Busco primero los ids de aquellos que se vendieron el último día, y luego hago el join en base a eso.

VENTAS1 = ρ VENTAS1 (Ventas)
VENTAS2 = ρ VENTAS2 (Ventas)
NEWEST_VENTAS = VENTAS1 ⋊⋉ (VENTAS1.fecha_venta > VENTAS2.fecha_venta) VENTAS2
IDS_INVENTARIO_NEWEST = π id_inventario (Ventas) - π VENTAS2.id_inventario (NEWEST_VENTAS)
IDS_PRODUCTO_NEWEST = π id (IDS_INVENTARIO_NEWEST  ⋊⋉ (IDS_INVENTARIO_NEWEST.id_inventario = id Inventario))
PRODUCTOS_NEWEST = IDS_PRODUCTO_NEWEST ⋊⋉ (IDS_PRODUCTO_NEWEST.id = id Productos)
π nombre (PRODUCTOS_NEWEST)


